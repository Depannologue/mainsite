[{"name":"sql.active_record","payload":{"sql":"SELECT  \"interventions\".* FROM \"interventions\" WHERE \"interventions\".\"client_token_ownership\" IS NULL LIMIT 1","name":"Intervention Load","connection_id":22811480,"statement_name":null,"binds":[],"line":172,"filename":"/home/depanologue/dev/depannologue/app/controllers/client/intervention_steps_controller.rb","method":"_current_intervention"},"time":"2016-06-20T10:47:11.295+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:11.296+02:00","children":[],"duration":0.970033},{"name":"sql.active_record","payload":{"sql":"SELECT  \"interventions\".* FROM \"interventions\" WHERE \"interventions\".\"client_token_ownership\" = $1 LIMIT 1","name":"Intervention Load","connection_id":22811480,"statement_name":"a3","binds":[[{"array":false,"name":"client_token_ownership","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":true,"default":null,"default_function":null},"c11e56788ff179f8df4d453ad652bf53c50fb0c96502b36bf5"]],"line":181,"filename":"/home/depanologue/dev/depannologue/app/controllers/client/intervention_steps_controller.rb","method":"_current_intervention"},"time":"2016-06-20T10:47:11.297+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:11.298+02:00","children":[],"duration":0.813701},{"name":"sql.active_record","payload":{"sql":"SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"email\" = $1  ORDER BY \"users\".\"id\" ASC LIMIT 1","name":"User Load","connection_id":22811480,"statement_name":"a11","binds":[[{"array":false,"name":"email","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":false,"default":"","default_function":null},"eee@ff.fr"]],"line":66,"filename":"/home/depanologue/dev/depannologue/app/models/intervention.rb","method":"customer_attributes="},"time":"2016-06-20T10:47:11.301+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:11.302+02:00","children":[],"duration":0.744819},{"name":"sql.active_record","payload":{"sql":"SELECT  \"addresses\".* FROM \"addresses\" WHERE \"addresses\".\"addressable_id\" = $1 AND \"addresses\".\"addressable_type\" = $2 LIMIT 1","name":"Address Load","connection_id":22811480,"statement_name":"a4","binds":[[{"array":false,"name":"addressable_id","cast_type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"sql_type":"integer","null":true,"default":null,"default_function":null},28],[{"array":false,"name":"addressable_type","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":true,"default":null,"default_function":null},"Intervention"]],"line":89,"filename":"/home/depanologue/dev/depannologue/app/controllers/client/intervention_steps_controller.rb","method":"update"},"time":"2016-06-20T10:47:11.304+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:11.305+02:00","children":[],"duration":1.040515},{"name":"sql.active_record","payload":{"sql":"SELECT  1 AS one FROM \"users\" WHERE \"users\".\"email\" = 'eee@ff.fr' LIMIT 1","name":"User Exists","connection_id":22811480,"statement_name":null,"binds":[],"line":94,"filename":"/home/depanologue/dev/depannologue/app/controllers/client/intervention_steps_controller.rb","method":"update"},"time":"2016-06-20T10:47:11.310+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:11.311+02:00","children":[],"duration":0.740426},{"name":"sql.active_record","payload":{"sql":"BEGIN","name":null,"connection_id":22811480,"statement_name":null,"binds":[],"line":94,"filename":"/home/depanologue/dev/depannologue/app/controllers/client/intervention_steps_controller.rb","method":"update"},"time":"2016-06-20T10:47:11.312+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:11.313+02:00","children":[],"duration":0.546308},{"name":"sql.active_record","payload":{"sql":"              SELECT a.attname, format_type(a.atttypid, a.atttypmod),\n                     pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod\n                FROM pg_attribute a LEFT JOIN pg_attrdef d\n                  ON a.attrelid = d.adrelid AND a.attnum = d.adnum\n               WHERE a.attrelid = '\"historical_transitions\"'::regclass\n                 AND a.attnum \u003e 0 AND NOT a.attisdropped\n               ORDER BY a.attnum\n","name":"SCHEMA","connection_id":22811480,"statement_name":null,"binds":[],"line":163,"filename":"/home/depanologue/dev/depannologue/app/models/intervention.rb","method":"_build_historical_transition"},"time":"2016-06-20T10:47:11.319+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:11.320+02:00","children":[],"duration":1.0026970000000002},{"name":"sql.active_record","payload":{"sql":"            SELECT attr.attname\n            FROM pg_attribute attr\n            INNER JOIN pg_constraint cons ON attr.attrelid = cons.conrelid AND attr.attnum = any(cons.conkey)\n            WHERE cons.contype = 'p'\n              AND cons.conrelid = '\"historical_transitions\"'::regclass\n","name":"SCHEMA","connection_id":22811480,"statement_name":null,"binds":[],"line":163,"filename":"/home/depanologue/dev/depannologue/app/models/intervention.rb","method":"_build_historical_transition"},"time":"2016-06-20T10:47:11.322+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:11.323+02:00","children":[],"duration":1.076948},{"name":"sql.active_record","payload":{"sql":"SELECT  1 AS one FROM \"users\" WHERE \"users\".\"email\" = 'eee@ff.fr' LIMIT 1","name":"User Exists","connection_id":22811480,"statement_name":null,"binds":[],"line":94,"filename":"/home/depanologue/dev/depannologue/app/controllers/client/intervention_steps_controller.rb","method":"update"},"time":"2016-06-20T10:47:11.332+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:11.333+02:00","children":[],"duration":0.837711},{"name":"sql.active_record","payload":{"sql":"INSERT INTO \"users\" (\"email\", \"role\", \"firstname\", \"lastname\", \"phone_number\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING \"id\"","name":"SQL","connection_id":22811480,"statement_name":"a12","binds":[[{"array":false,"name":"email","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":false,"default":"","default_function":null},"eee@ff.fr"],[{"array":false,"name":"role","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":false,"default":null,"default_function":null},"customer"],[{"array":false,"name":"firstname","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":true,"default":null,"default_function":null},"ee"],[{"array":false,"name":"lastname","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":true,"default":null,"default_function":null},"ee"],[{"array":false,"name":"phone_number","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":true,"default":null,"default_function":null},"+33761154358"],[{"array":false,"name":"created_at","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"timestamp without time zone","null":false,"default":null,"default_function":null},"2016-06-20 08:47:11.335503"],[{"array":false,"name":"updated_at","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"timestamp without time zone","null":false,"default":null,"default_function":null},"2016-06-20 08:47:11.335503"]],"line":94,"filename":"/home/depanologue/dev/depannologue/app/controllers/client/intervention_steps_controller.rb","method":"update"},"time":"2016-06-20T10:47:11.337+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:11.339+02:00","children":[],"duration":1.606987},{"name":"sql.active_record","payload":{"sql":"UPDATE \"interventions\" SET \"payment_method\" = $1, \"state\" = $2, \"customer_id\" = $3, \"updated_at\" = $4 WHERE \"interventions\".\"id\" = $5","name":"SQL","connection_id":22811480,"statement_name":"a13","binds":[[{"array":false,"name":"payment_method","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":true,"default":null,"default_function":null},"credit_card"],[{"array":false,"name":"state","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":true,"default":null,"default_function":null},"pending_pro_validation"],[{"array":false,"name":"customer_id","cast_type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"sql_type":"integer","null":true,"default":null,"default_function":null},24],[{"array":false,"name":"updated_at","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"timestamp without time zone","null":false,"default":null,"default_function":null},"2016-06-20 08:47:11.342590"],[{"array":false,"name":"id","cast_type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"sql_type":"integer","null":false,"default":null,"default_function":"nextval('interventions_id_seq'::regclass)"},28]],"line":94,"filename":"/home/depanologue/dev/depannologue/app/controllers/client/intervention_steps_controller.rb","method":"update"},"time":"2016-06-20T10:47:11.344+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:11.345+02:00","children":[],"duration":0.93306},{"name":"sql.active_record","payload":{"sql":"UPDATE \"addresses\" SET \"firstname\" = $1, \"lastname\" = $2, \"updated_at\" = $3 WHERE \"addresses\".\"id\" = $4","name":"SQL","connection_id":22811480,"statement_name":"a14","binds":[[{"array":false,"name":"firstname","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":true,"default":null,"default_function":null},"ee"],[{"array":false,"name":"lastname","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":true,"default":null,"default_function":null},"ee"],[{"array":false,"name":"updated_at","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"timestamp without time zone","null":false,"default":null,"default_function":null},"2016-06-20 08:47:11.347535"],[{"array":false,"name":"id","cast_type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"sql_type":"integer","null":false,"default":null,"default_function":"nextval('addresses_id_seq'::regclass)"},30]],"line":94,"filename":"/home/depanologue/dev/depannologue/app/controllers/client/intervention_steps_controller.rb","method":"update"},"time":"2016-06-20T10:47:11.349+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:11.350+02:00","children":[],"duration":0.70009},{"name":"sql.active_record","payload":{"sql":"INSERT INTO \"historical_transitions\" (\"event\", \"from\", \"to\", \"processed_at\", \"historisable_id\", \"historisable_type\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING \"id\"","name":"SQL","connection_id":22811480,"statement_name":"a15","binds":[[{"array":false,"name":"event","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":true,"default":null,"default_function":null},"pay!"],[{"array":false,"name":"from","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":true,"default":null,"default_function":null},"pending"],[{"array":false,"name":"to","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":true,"default":null,"default_function":null},"pending_pro_validation"],[{"array":false,"name":"processed_at","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"timestamp without time zone","null":true,"default":null,"default_function":null},"2016-06-20 08:47:11.322035"],[{"array":false,"name":"historisable_id","cast_type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"sql_type":"integer","null":true,"default":null,"default_function":null},28],[{"array":false,"name":"historisable_type","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":true,"default":null,"default_function":null},"Intervention"],[{"array":false,"name":"created_at","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"timestamp without time zone","null":true,"default":null,"default_function":null},"2016-06-20 08:47:11.352001"],[{"array":false,"name":"updated_at","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"timestamp without time zone","null":true,"default":null,"default_function":null},"2016-06-20 08:47:11.352001"]],"line":94,"filename":"/home/depanologue/dev/depannologue/app/controllers/client/intervention_steps_controller.rb","method":"update"},"time":"2016-06-20T10:47:11.353+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:11.355+02:00","children":[],"duration":2.3701410000000003},{"name":"render_template.action_view","payload":{"identifier":"/home/depanologue/dev/depannologue/app/views/client_mailer/confirm_booking.html.haml","layout":"layouts/client/mailer"},"time":"2016-06-20T10:47:11.556+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:11.558+02:00","children":[],"duration":2.357503},{"name":"sql.active_record","payload":{"sql":"SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"invitation_token\" = $1  ORDER BY \"users\".\"id\" ASC LIMIT 1","name":"User Load","connection_id":22811480,"statement_name":"a16","binds":[[{"array":false,"name":"invitation_token","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":true,"default":null,"default_function":null},"fa7c271c176641ffea638a7dc1f73c36d741ede3cb31b4a72cfbe71c8a778f96"]],"line":85,"filename":"/home/depanologue/dev/depannologue/app/models/intervention.rb","method":"block (3 levels) in \u003cclass:Intervention\u003e"},"time":"2016-06-20T10:47:12.323+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:12.324+02:00","children":[],"duration":0.788981},{"name":"sql.active_record","payload":{"sql":"UPDATE \"users\" SET \"invitation_token\" = $1, \"invitation_created_at\" = $2, \"invitation_sent_at\" = $3, \"updated_at\" = $4 WHERE \"users\".\"id\" = $5","name":"SQL","connection_id":22811480,"statement_name":"a17","binds":[[{"array":false,"name":"invitation_token","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":true,"default":null,"default_function":null},"fa7c271c176641ffea638a7dc1f73c36d741ede3cb31b4a72cfbe71c8a778f96"],[{"array":false,"name":"invitation_created_at","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"timestamp without time zone","null":true,"default":null,"default_function":null},"2016-06-20 08:47:12.325208"],[{"array":false,"name":"invitation_sent_at","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"timestamp without time zone","null":true,"default":null,"default_function":null},"2016-06-20 08:47:12.325208"],[{"array":false,"name":"updated_at","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"timestamp without time zone","null":false,"default":null,"default_function":null},"2016-06-20 08:47:12.325700"],[{"array":false,"name":"id","cast_type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"sql_type":"integer","null":false,"default":null,"default_function":"nextval('users_id_seq'::regclass)"},24]],"line":85,"filename":"/home/depanologue/dev/depannologue/app/models/intervention.rb","method":"block (3 levels) in \u003cclass:Intervention\u003e"},"time":"2016-06-20T10:47:12.326+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:12.327+02:00","children":[],"duration":0.750021},{"name":"render_template.action_view","payload":{"identifier":"/home/depanologue/dev/depannologue/app/views/client_mailer/invitation_instructions.html.haml","layout":"layouts/client/mailer"},"time":"2016-06-20T10:47:12.347+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:12.349+02:00","children":[],"duration":2.365393},{"name":"sql.active_record","payload":{"sql":"COMMIT","name":null,"connection_id":22811480,"statement_name":null,"binds":[],"line":94,"filename":"/home/depanologue/dev/depannologue/app/controllers/client/intervention_steps_controller.rb","method":"update"},"time":"2016-06-20T10:47:12.856+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:12.858+02:00","children":[],"duration":1.8161749999999999},{"name":"sql.active_record","payload":{"sql":"SELECT  \"zip_codes\".* FROM \"zip_codes\" WHERE \"zip_codes\".\"zipcode\" = $1 LIMIT 1","name":"ZipCode Load","connection_id":22811480,"statement_name":"a6","binds":[[{"array":false,"name":"zipcode","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":true,"default":null,"default_function":null},"59000"]],"line":150,"filename":"/home/depanologue/dev/depannologue/app/models/intervention.rb","method":"pros_now_available_and_nearby"},"time":"2016-06-20T10:47:12.859+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:12.860+02:00","children":[],"duration":0.6126839999999999},{"name":"sql.active_record","payload":{"sql":"SELECT  \"areas\".* FROM \"areas\" WHERE \"areas\".\"id\" = $1 LIMIT 1","name":"Area Load","connection_id":22811480,"statement_name":"a7","binds":[[{"array":false,"name":"id","cast_type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"sql_type":"integer","null":false,"default":null,"default_function":"nextval('areas_id_seq'::regclass)"},1]],"line":151,"filename":"/home/depanologue/dev/depannologue/app/models/intervention.rb","method":"pros_now_available_and_nearby"},"time":"2016-06-20T10:47:12.861+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:12.861+02:00","children":[],"duration":0.586513},{"name":"sql.active_record","payload":{"sql":"SELECT \"users\".* FROM \"users\" INNER JOIN \"user_areas\" ON \"users\".\"id\" = \"user_areas\".\"user_id\" WHERE \"user_areas\".\"area_id\" = $1 AND \"users\".\"role\" = $2 AND \"users\".\"role\" = $3","name":"User Load","connection_id":22811480,"statement_name":"a8","binds":[[{"array":false,"name":"area_id","cast_type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"sql_type":"integer","null":true,"default":null,"default_function":null},1],[{"array":false,"name":"role","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":false,"default":null,"default_function":null},"contractor"],[{"array":false,"name":"role","cast_type":{"precision":null,"scale":null,"limit":null},"sql_type":"character varying","null":false,"default":null,"default_function":null},"contractor"]],"line":96,"filename":"/home/depanologue/dev/depannologue/app/models/user.rb","method":"available_now"},"time":"2016-06-20T10:47:12.864+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:12.864+02:00","children":[],"duration":0.906102},{"name":"sql.active_record","payload":{"sql":"SELECT  \"exceptional_availabilities\".* FROM \"exceptional_availabilities\" WHERE \"exceptional_availabilities\".\"user_id\" = $1 AND (\"exceptional_availabilities\".\"created_at\" BETWEEN '2016-06-20 06:00:00.000000' AND '2016-06-20 09:59:59.999999')  ORDER BY \"exceptional_availabilities\".\"created_at\" DESC LIMIT 1","name":"ExceptionalAvailability Load","connection_id":22811480,"statement_name":"a9","binds":[[{"array":false,"name":"user_id","cast_type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"sql_type":"integer","null":true,"default":null,"default_function":null},7]],"line":104,"filename":"/home/depanologue/dev/depannologue/app/models/user.rb","method":"available_now?"},"time":"2016-06-20T10:47:12.867+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:12.867+02:00","children":[],"duration":0.583512},{"name":"sql.active_record","payload":{"sql":"SELECT  \"weekly_availabilities\".* FROM \"weekly_availabilities\" WHERE \"weekly_availabilities\".\"user_id\" = $1 LIMIT 1","name":"WeeklyAvailability Load","connection_id":22811480,"statement_name":"a10","binds":[[{"array":false,"name":"user_id","cast_type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"sql_type":"integer","null":true,"default":null,"default_function":null},7]],"line":107,"filename":"/home/depanologue/dev/depannologue/app/models/user.rb","method":"available_now?"},"time":"2016-06-20T10:47:12.868+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:12.869+02:00","children":[],"duration":0.602893},{"name":"render_template.action_view","payload":{"identifier":"/home/depanologue/dev/depannologue/app/views/pro_mailer/notify_intervention_created.html.haml","layout":"layouts/pro/mailer"},"time":"2016-06-20T10:47:12.887+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:12.890+02:00","children":[],"duration":2.69402},{"name":"process_action.action_controller","payload":{"controller":"Client::InterventionStepsController","action":"update","params":{"utf8":"✓","_method":"patch","authenticity_token":"si/F922c0sOeOSEAJL9lvlgcVwHH+laSc9spr1MXIoa3iRkyKhmIaSgLLlol7mJqqoiE/l1KYJXPfoC1fLmCgg==","payment_method":"credit_card","intervention":{"customer_attributes":{"firstname":"ee","lastname":"ee","email":"eee@ff.fr"}},"cgu":"1","commit":"Réserver","controller":"client/intervention_steps","action":"update","id":"payment"},"format":"html","method":"PATCH","path":"/payment","status":302,"view_runtime":null,"db_runtime":12.852820999999999},"time":"2016-06-20T10:47:11.293+02:00","transaction_id":"c7f77536d7d27c511fa5","end":"2016-06-20T10:47:13.321+02:00","children":[],"duration":2027.96788}]